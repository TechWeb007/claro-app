generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Company {
  id             String   @id @default(cuid())
  name           String
  email          String
  domain         String   @unique
  apiKey         String?   @unique
  pricingInfo    String?     // JSON or text for service pricing
  aiPrompt       String?
  quoteTemplate  String?
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  conversations  Conversation[]
  quotes         Quote[]
}


model Conversation {
  id          String   @id @default(cuid())
  companyId   String
  messages    Json
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  company     Company  @relation(fields: [companyId], references: [id])
  summary     ConversationSummary?
}

model ConversationSummary {
  id              String   @id @default(cuid())
  conversationId  String   @unique
  summary         String
  createdAt       DateTime @default(now())

  conversation    Conversation @relation(fields: [conversationId], references: [id])
}

model Quote {
  id           String   @id @default(cuid())
  companyId    String
  name         String
  email        String
  phone        String
  address      String
  paymentLink  String?
  quoteMessage String?
  createdAt    DateTime   @default(now())

  company      Company    @relation(fields: [companyId], references: [id])
}


model DeviceIssueStat {
  id                 String   @id @default(cuid())
  companyId          String   // FK value, no explicit relation needed
  conversationId     String?  // FK value, no explicit relation needed

  serviceType        String?  // e.g. "printer_repair"
  deviceType         String?  // e.g. "laser_printer"
  deviceBrand        String?  // e.g. "Brother"
  deviceModel        String?  // e.g. "MFC-L2750DW"
  problemDescription String?  // text summary of issue

  createdAt          DateTime @default(now())
}



